# 日常记录

## Start flow

https://spaces.telenav.com:8443/display/~xlliu@telenavsoftware.com/HMI+startup+flow+and+External+dependency

## Rainier cluster篇

```
启动cluster步骤
su
leoflashutil
port master_slave set 1 slave
port info 1
config save
启动hud:
echo "MSG_ID_HUD_Connect_Status_In:i:1" >> /pps/services/status
echo "MSG_ID_P_NG_MOST_HUD_PRESENT_In:b:true" >> /pps/services/status
ls -al /dev/screen/HUDApp/ | grep "win-" | awk '{if(match($9, "win-"))system("screencmd setpv "$9" SCREEN_PROPERTY_DISPLAY dpy-1")}';
ls -al /dev/screen/HUDApp/ | grep "win-" | awk '{if(match($9, "win-"))system("screencmd setllv "$9" SCREEN_PROPERTY_PIPELINE 13")}';
ls -al /dev/screen/HUDApp/ | grep "win-" | awk '{if(match($9, "win-"))system("screencmd setllv "$9" SCREEN_PROPERTY_ZORDER 4")}';
ls -al /dev/screen/HUDApp/ | grep "win-" | awk '{if(match($9, "win-"))system("screencmd setiv "$9" SCREEN_PROPERTY_POSITION 200,100")}';
```



### Structure

![image-20210317132810141](C:\Users\mxshang\AppData\Roaming\Typora\typora-user-images\image-20210317132810141.png)

### SpeedLimit

![image-20210317160334980](C:\Users\mxshang\AppData\Roaming\Typora\typora-user-images\image-20210317160334980.png)

### Other messages

在SmartHorizonSignalProvider中，其他的message是如何发送出去的。

1. receiveAdasMessage中把message添加到list receiveQueue中
2. 如果list容量大于5000了，就删除前一半的message，startBroadcast()，不到5000就什么也不做。
3. 把receiveQueue的内容给新的list-switchQueue，清空receiveQueue
4. 发送广播，把switchQueue清空，那么发送的东西只有后一半？
5. 根据描述，超过5000的概率几乎不存在，那这种情况就什么都不做？(存疑)

### Log keywords

Provided by Sherry, thx

> 1. **viewId** to check which type cluster or HUD 
> 2.  **updateLabelWidget** check all the label text that shows on Cluster
> 3.  **showCurrentScreen**  check all the **screen** that cluster or HUD experience
> 4.  **templateId** check all the **screen or HUD** that cluster or HUD experience
> 5.  **ManeuverAlert create for**  checked the **ManeuverAlert** that create for Cluster or HUD
> 6.  **display Type** through the display type could check if it is a Cluster or HUD and which type it is

Check if **speedlimit** sent to system: **SpeedLimitPostedSpeed.setValue**

### Issue classify

From Sherry

> **Cluster layout and font size is Harman controlled by Harman, if has problem, it might be Harman's issue.**
>
> **Harman provide their customized widget for Cluster, so when we implement the view of Cluster we should use their SDK which located at: android-sdk_jenkins-harman-info3-lp-my18-release-SDK-32_windows\docs\reference\gm\cluste**
>
> **Cluster entry is DenaliClusterService, coummunicate with HMI used aidl.**
>
> **ClusterMapEngine initialized GLEngineJNI not use SurfaceView, because it's need encode and decode video.**
>
> **Cluster showed the view is just a video, before show view, it's experienced the process of encode and decode video.**

[小丽姐修过的bugs](https://spaces.telenav.com:8443/display/~xlliu@telenavsoftware.com/Cluster+typical+cases)

### Maneuver Alert

[小丽姐的笔记](https://spaces.telenav.com:8443/display/~xlliu@telenavsoftware.com/Cluster+Maneuver+Alert+Update+Flow2)

### Update UI

[小丽姐的笔记](https://spaces.telenav.com:8443/display/~xlliu@telenavsoftware.com/Cluster+update+UI+flow)

## Voice 相关

### Log keyword

guidance voice volume -> **setStreamVolume**

recover Volume after calling -> **recoverVolume**

phone state -> **PhoneStateProvider**

guide voice -> **voice data **or [audio]

发送TTS成功：synthesizeText result: SUCCESS

完整的

```
"Setting TTS Play state to requestReceived"
"Setting TTS Play state to playStart"
"Setting TTS Play state to playing"
"Setting TTS Play state to playEnd"
"Setting TTS Play state to notPlaying"
```

Carplay 申请TTS

requestAudioPermission: requestedStreamId=4123



语音播放方法：

```
notifyVoiceGuidance:AutoSdkNavigationServiceWrapper->playVoiceGuidance:DenaliVoiceGuidancePlaybackStrategy->play:VoiceGuidanceCenter ->playDirectly->synthesizeText->abandon->play
```

## VR

https://jira.telenav.com:8443/browse/RAIN-15950

https://spaces.telenav.com:8443/pages/viewpage.action?pageId=155469630

## MFC相关

### Log keyword

MFC mode -> **isInMfcMode**

## UI相关

### Log keyword

Height big panel-> **updateHeaderViewHeight**

save or cancel Favorites -> **Favorites** or **detail**

```
slopedDegree 控制 坡度
```

### detail entity

detail 页面 -> EntityPanel:地址，距离都在上面。

相关fragment:

```
MainEntityDetailFragment
```

https://jira.telenav.com:8443/browse/DEN-57696

## Search相关

**所有的search的方法都在AutoSdkEntityServiceWrapperEntityV4Binding中**

模板：

[丹姐的处理模板](https://jira.telenav.com:8443/browse/RAIN-15982)

1. 附上格式化的request和response ，json格式的，关键log：**cloud_response**， **[search]**, **searchEntityDetail**
2. 附上HMI版本号，Map 版本，search version, 在log中搜索version 获取HMI版本，在wiki中搜索，即可获取search版本
3. clone这个问题，类型是search的，然后分配给search team
4. https://spaces.telenav.com:8443/display/~dzhao@telenavsoftware.com/EV+Search+Result

### Log

**interruptibleRequest** - > request

**SearchNearBy**-> see if search nearby

**LogShedEventHandler event queue add**->可以看用户的一些操作,动作结束后才会出现

**task is started action** (动作的开始)or **task model change is handled**（动作的结束） -> 看搜索的類型（非缓存）

**clearLimitationForDriving**->已经返回search result（不管是不是缓存得，显示结果的时候都会显示出来）

**request takes**->time

**can search log of XX.java to get log**

Search result -> **cloud_response**

**oneBox:, query:null**->结束后会出现比如nearby，nearDestination，走缓存不会出现

**modelChanged** ->结束后会出现，但是走缓存不会出现。

**[PAN_MAP]**-> 是否滑动地图

**updateAnnotation**->更新annotation

注意：action是在page中传过去的

**highway exit** 获得 exit的坐标

**exitSearch**获得request 和 response

### 流程

![image-20210324152247983](C:\Users\mxshang\AppData\Roaming\Typora\typora-user-images\image-20210324152247983.png)

返回的结果都返回到了displaySearchResult中的searchResults中，在notifyDataSetChanged中把所有的数据放进去。

![image-20210325170440464](C:\Users\mxshang\AppData\Roaming\Typora\typora-user-images\image-20210325170440464.png)

response 

### Time out

```
AutoSdkEntityServiceWrapperEntityV4Binding:
parallelSearch():time out -> response =null
isCloudSearchFailed(response)->true
response = onboardResult.get()

response -> getEntitySearchResponse((cloudEntityServiceHolder.search))->filtedEntitySearch()->search()->AutoSdkEntityService.java->search()->SearchApiService.java->handle()
```

### API key

在environment.json

### 关于detail

EntityDetailPageTask.java

```
sendSearchDetailRequest:
  EntityDetailResponse response = AutoSdkEntityService.getInstance().detail(request);
  SearchLogUtils.detail(request, response, this.getClass(), ArpLogFilter.LOG_MODULE);
```

获取response过程：

```
detail->getEntityDetailResponse
if cloud->cloudEntityServiceHolder.detail
onboard->getEntityDetailResponseFuture
```

更新UI在EntityDetailFragment中的updateFacetInfo調用showParkingPriceDetail:

### wifi情况下调用onboard

> Search call useOnboardSearch current service type: Embedded isRequestOnBoard  : true network status : Wifi

是secret设置成force onboard

The value of **service_type** is obtained from **sharedPerference**, if **sharedPerference is null** then use the default value"**Hybrid** " from the Config file. However, only on the **secret page**, we can set the value of the Search Model into sharedPerference, so usually, we use the default search mode "Hybrid ". In the log, I saw it is **not a production version**, so **could you please confirm if anyone set the "force onboard search" as the "true" on the secret page?**

```
String entity_service_type = ApplicationContextHelper.getInstance().getConfigSettings(ApplicationContextHelper.KEY_ENTITY_SERVICE_TYPE);
boolean connectionAvailable = Feature.State.Subscribed == FeatureCollectionFactory.getFeatureCollection().getFeatureState(Feature.Name.Connectivity)
        || Feature.State.Active == FeatureCollectionFactory.getFeatureCollection().getFeatureState(Feature.Name.Connectivity);
Log.i(ArpLogFilter.LOG_MODULE, "MainApplication connectionAvailable: " + connectionAvailable);
if (!connectionAvailable) {
    entity_service_type = AutoSdkEntityService.TYPE_EMBEDDED;
}
if (Region.KR.getValue().equals(manifestRegion) && ApplicationContextHelper.getInstance().getBoolean(ApplicationContextHelper.KEY_ENABLE_STREAMING_MAP)) {
    entity_service_type = AutoSdkEntityService.TYPE_CLOUD;
    Log.i(ArpLogFilter.LOG_MODULE, "KR MainApplication entity_service_type: " + entity_service_type);
}
if (entity_service_type != null && entity_service_type.length() > 0) {
    Log.i(ArpLogFilter.LOG_MODULE, "MainApplication entity_service_type: " + entity_service_type);
    autoSdkConfiguration.put(AutoSdkConfiguration.KEY_SDK_ENTITY_SERVICE_TYPE, entity_service_type);
}
```

### SharedPerference

```
setConfigValue
arpConfig.edit().putString 放入值//在secret調用
```

/data/data/com.telenav.app.denali.na/shared_prefs/com.telenav.arp.config.xml

```
updateSystemPowerMode->clearAllUserSetting
```

## Data 相关

CommonProtoBuf2VOHelper



## Android studio相关

ctrl + b 可以点进去

alt f7 看变量使用

shift f6 批量修改变量

## ADB相关

远程：

adb tcpip 5555

adb connect 10.66.39.59:5555

关闭app

1. `adb shell ps | grep sohu`

   windows下这个指令会提示grep找不到，可以加双引号解决

   ` adb shell "ps|grep com.xxx"`

2. `adb shell am force-stop XXX`

查看所有进程及内存占用等

`adb shell ps`

查看某个进程的内存占用情况

`adb shell dumpsys meminfo`

打开secret页面

`adb shell am start com.telenav.app.denali.na/com.telenav.arp.module.secret.SecretScreenActivity`

关掉服务

```
adb kill-server
```

传文件

`adb push`

拿文件

`adb pull`

打开文件目录

`adb start .`

log

```
adb logcat | find  "XXX" > myLog2.txt
```

//格式1：打印默认日志数据
`adb logcat `

//格式2：需要打印日志详细时间的简单数据
`adb logcat -v time`

//格式3：需要打印级别为Error的信息
`adb logcat *:E`

//格式4：需要打印时间和级别是Error的信息
`adb logcat -v time *:E`

//格式5：将日志保存到电脑固定的位置，比如D:\log.txt
`adb logcat -v time >D:\log.txt`

```yaml
1、adb devices 查看手机设备
2、adb install packsge(包路径)安装包
3、adb install -r packages(保留数据及缓存文件安装新包)
4、adb uninstall package (卸载包)
5、adb kill-server 关闭adb服务
6、adb start-server 启动adb服务
7、adb shell pm list packages 查看手机里面所有包名
8、adb shell pm list packages -3查看手机里面所有第三方包名
9、adb shell /system/bin/screencap -p /sdcard/xx.png 截频并保存文件在手机上为xx.Png
10、adb pull /sdcard/xx.png D:/xx.png 将手机xx.png文件保存到D盘文件下
11、adb push D:/xx.text /adcard/xx.text 将电脑文件导入手机
12、adb shell pm clear com.ablesky.ui.activity 清除缓存数据
13、adb shell am start -n com.ablesky.ui.activity/com.ablesky.activity.SplashActivity 启动程序
14、adb shell am force-stop com.ablesky.simpleness.activity 强制停止运行程序
15、adb logcat 查看日志
16、adb logcat > D:\log.txt 将日志打印到电脑上
17、netstat -aon|findstr "5037" 查看被占用端口对应的PID
18、 tasklist /fi “PID eq PID号” 查看端口号对应的进程
19、 taskkill /pid 2027 /f  杀掉某进程
20、adb shell monkey -p 包名 100    指定APP产生随机事件100次 
21、adb shell monkey -p 包名 -v -v 100    指定APP产生随机事件100次并发送详细的activity信息  
```

```text
1、获取手机系统信息（ CPU，厂商名称等）
adb shell "cat /system/build.prop | grep "product""
2、获取手机系统版本
adb shell getprop ro.build.version.release
3、获取手机系统api版本
adb shell getprop ro.build.version.sdk
4、获取手机设备型号
adb -d shell getprop ro.product.model
5、获取手机厂商名称
adb -d shell getprop ro.product.brand
6、获取手机的序列号
有两种方式
1、  adb get-serialno
2、  adb shell getprop ro.serialno
7、获取手机的IMEI
有三种方式，由于手机和系统的限制，不一定获取到
1、 adb shell dumpsys iphonesubinfo其中Device ID即为IMEI号
2、 adb shell getprop gsm.baseband.imei
3、 service call iphonesubinfo 1
此种方式，需要自己处理获取的信息得到
8、获取手机mac地址
adb shell cat /sys/class/net/wlan0/address
9、获取手机内存信息
adb shell cat /proc/meminfo
10、获取手机存储信息
adb shell df
获取手机内部存储信息：
魅族手机： adb shell df /mnt/shell/emulated
其他： adb shell df /data
获取sdcard存储信息：
adb shell df /storage/sdcard
11、获取手机分辨率
adb shell "dumpsys window | grep mUnrestrictedScreen"
12、获取手机物理密度
adb shell wm density
13、获取手机包名
1.查看指定apk的包名：aapt dump badging +包的全路径
2.查看所有apk包名：adb shell pm list package -f
```

## Windos 命令

查看pid对应得进程

> wmic process get name,executablepath,processid|findstr pid

查看占用端口得进程

> netstat  -ano|findstr 8088

kill pid对应得进程

> taskkill /pid 2732 -t -f

## 正則表達

1，包含a和b：

                        ^(?=.*a)(?=.*b).*$

补充，如果多行里面有a和b那么就是下面表达式，因为.只是正则中除了\n的任意字符，想要匹配任意字符需要(.|\n)

^(?=(.|\n)*a)(?=(.|\n)*b)(.|\n)*$

2，包含a不包含b：

                        ^((?!b.)*a((?!b).)*$
    
                       例:包含admin且不包含abc。
    
                      ^((?!abc).)*admin((?!abc).)*$

3，包含a不包含b和c：

                        ^((?!b|c).)*a((?!b|c).)*$

## API key

\Denali\hmi-common\NavHome\Apps\Denali\HMI\src\main\assets\app\config\environment.config.json

有两个，一个是MAIN的，一个是Production的，Main里面都包含

## 环境配置篇

### MY20 :

https://spaces.telenav.com:8443/display/~dzhao@telenavsoftware.com/How+to+Set+Up+Infor+3.5+MY20+Environment

如果遇见找不到useAtlasEngine propertity, 在gradle.properties 加上`useAtlasEngine= false`

只能用Android studio 2.3，用其他的就会出现cant find method 或者v4和v13冲突。

java sdk的位置在setting.gradle设置，如：

```
    include ':arp-sdk', ':arp-foundation', ':android-common', ':mapPoi', ':Blackbox'
    project(':arp-sdk').projectDir = new File(rootProject.projectDir, '../../../java-sdk-common/java_sdk/arp-sdk')
    project(':arp-foundation').projectDir = new File(rootProject.projectDir, '../../../java-sdk-common/java_sdk/arp-foundation')
    project(':android-common').projectDir = new File(rootProject.projectDir, '../../../java-sdk-common/java_sdk/android-common')
    project(':mapPoi').projectDir = new File(rootProject.projectDir, '../../../java-sdk-common/java_sdk/mapPoi')
    project(':Blackbox').projectDir = new File(rootProject.projectDir, '../../../java-sdk-common/java_sdk/Blackbox')
```

### MY21：

https://spaces.telenav.com:8443/display/~bwu2@telenavsoftware.com/How+to+set+up+Denali+MY21+Project

### Rainier:

https://spaces.telenav.com:8443/display/~xbai@telenavsoftware.com/Codebase+run+instructions

## Git 

**git log --oneline --graph**

```undefined
git rebase -i HEAD~3 
git commit --amend 修改commit
git reset --soft HEAD~1 删掉上一次commit
git gc --prune=now
git remote prune origin
```

如果让你输入SSH密码，还一直错，那就之间重装。

git merging

本地切分支

> git branch feature/SXM-82-add-get-Vehicle-Location-Producer
>
>  git push --set-upstream origin feature/SXM-82-add-get-Vehicle-Location-Producer

## Release

1. 修改arp下的dependencies_version 中的：

   ```
   ext.navkitVersion = '2.94.495090'
   ext.mapEngineVersion = '1.14.0+bfd4d31b'
   ext.mapEnginePath = 'denali-info3.6-my21/denali-info3.6-my21-rc23'
   ```

   期中，mapEngineVersion可以在https://artifactory.telenav.com/telenav-ivy-preprod/v2/nav/navcore/nav-release/denali-info3.6-my21/denali-info3.6-my21-rc23/android-ndk-r15c/中的MapEngineBatman.xml 获取。

2. 修改Nav下的dependencies_version.gradle

   ```
   ext.batmanAutoSDKVersion = '4.2.17224'
   ext.batmanEngineVersion = '1.14.0+bfd4d31b'
   ext.batmanEnginePath = 'denali-info3.6-my21/denali-info3.6-my21-rc23'
   ```

3. 修改gradle.properties下的buildSprint=153.3
4. 在Jenkins上编译sdk，然后编译HMI。
5. 编辑wiki，发邮件, 确保wiki上的版本号都是一致的，HMI和RSI

bench的开关在后面，右手有个可以操作cluster的东西，cluster在最上面，注意数据是否正确，利用bat的tool把新版本安装进去。

## 编译失败：

> **Failed to resolve attribute at index**

AndroidManifest的主题设置。

> !zip.isfile

clean。

## 语音输入

相关bug：

[识别错误](https://jira.telenav.com:8443/browse/RAIN-15950?filter=-1&jql=project%20%3D%20RAIN%20AND%20assignee%20in%20(%22dzhao%40telenavsoftware.com%22)%20order%20by%20updated%20DESC)

Nuance issue

## 专业术语

AGV: active guide view

IGV: Inactive ..

CVP (current vehicle position)

## EV 

判断是否是EV

```
ApplicationContextHelper.isEV()
```

EV支持的功能：**isSupportRangeProjection**()

车的基本设置：**DenaliVehicleCalibrations**

一些配置在这个目录下修改：D:\Denali\hmi-common\NavHome\Apps\Denali\HMI\src\main\assets\app\config\eu\app.config.properties

Catrgories 也是从json文件取得的

EV的type 显示是从sharepreference 拿的getCurrentSetting

在EVOneboxFlow中有kr detail页面的设置

## Gradlew

在后面加上 --console plain

```
gradlew LandingPageData: testReleaseUnitTest
gradlew -?/-h/--help：显示帮助信息，即会打印可选参数及参数说明信息；

gradlew -v/--version：版本号（会打印工程用的Gradle的版本号、Kotlin、Groovy、Ant、JVM、OS等的版本号）；

gradlew tasks --all：查看所有任务，包括缓存任务等；

gradlew clean --console plain：清除工程目录下的build文件夹；

gradlew build： 检查依赖并编译打包，debug、release环境的包都会打出来；

gradlew assemble***：编译指定的包：如Debug包（gradlew assembleDebug）、Release包（gradlew assembleRelease）、渠道包（gradlew assembleOemRelease/assembleOemDebug）、定制的版本等等；

gradlew install***：编译并安装指定的包：如Debug包（gradlew installDebug）、Release包（gradlew installOemRelease/installOemDebug）、定制的版本等等；

gradlew uninstall**：卸载已安装的指定模式的包：如Debug包（gradlew uninstallDebug）、Release包（gradlew uninstallRelease）、渠道包（gradlew uninstallOemRelease/uninstallOemDebug）、定制的版本等等；

gradlew :模块名称:dependencies，如gradlew :app:dependencies，作用：查看包依赖关系；

gradlew build -i/--info -d/--debug -s/--stacktrace：编译(build)并打印debug模式和info等级的日志及所用异常的堆栈信息(--stacktrace)；

gradlew clean build --refresh-dependencies：组合指令，清除构建(gradlew clean)并重新构建(gradlew build)，同时强制刷新依赖(gradlew --refresh-dependencies)；

gradlew --offline：离线模式，即让Gradle只使用本地cache里的依赖，如果cache中没有也不会更新依赖，而是提示编译失败；

gradlew --refresh-dependencies：强制刷新依赖，即检查依赖是否有更新比如动态版本、SHA1进行本地cache和远程仓库散列码的对比等，有更新则下载更新进行构建；使用这种方式可以避免手动删除cache；

--info：打印堆栈信息；

gradlew --daemon：守护进程，使用Gradle的守护进程构建，能够提高构建效率，如果守护进程没启动或现有的都处于忙碌状态，就启动一个守护进程；

gradlew --no-daemon：如果你已经配置为使用守护进程构建，可以使用该选项本次不用守护进程构建；

gradlew --continuous：连续构建，即任务队列中即使某个任务失败，不会终止执行，而是会继续执行下一个任务；

gradlew --parallel --parallel-threads=N：并行编译；

gradlew --configure-on-demand：按需编译。
```





## ANR

https://www.jianshu.com/p/3959a601cea6

log: am_anr



## Routing

删除路段： 

log: avoid segment



## Comment

### Search 问题：

贴request和response：

> From the log, we found that the request and response are as follows...

某某值不符合预期

> The value  of attribute A is empty and does not meet expectations

block问题，让search团队去查：

> **Current status**: Block.
>
> From analysis logs, the response returns the wrong XXX. Therefore I need the **search team** to do further analysis.

### Log不够用的情况：

> With the log provided, it is hard to get a clear explanation. 
>
> MainLog only contains logs XXX, but the bug happened from xxx pm to xxx.
>
> My guess is...
>
> Please provide more logs for further investigation

### 代码写错了

如果能很快调查出来：

> Description: 标题
> Root cause: code error, XXX
> Solution: XXX

如果不能

> By analyzing the log, we get...
>
> It seems like the xxx cause this issue
>
> The logic here is more complicated, I still need to do further investigation

人员

> rainier找国雷，Denali找heyu，然后找丹姐，search的张巨强，QA找祁超或者光辉，nav找Danny，map engine 找zhang mingming

## Linux

https://blog.csdn.net/weixin_44901564/article/details/97754142

## 长路

41.57249, -87.28233, 88  -> 42.331680, -83.047990

longsegment: 小车距离到turn，5mile. 5mile之后也放弃needconsider。第一声之后放弃needConsider.

有距离突变的问题，如果5mile，还没走到passing。或者第一声，还没走到passing。

needconsider一定是long,反之不然

在Rainier中，使用了long_segment_view，是<ViewStub>

https://www.jianshu.com/p/df8c1fca38bb



## Denali Cluster & PorchView

### PorchView： 主页上右边小的地图

https://spaces.telenav.com:8443/display/~xlliu@telenavsoftware.com/Cluster+tips?preview=%2F63748317%2F63748352%2FKnowledge+of+Porch+view+and+Cluster.pdf

[NavigationStatusCallback.java](https://bitbucket.telenav.com/projects/AUT/repos/arp/commits/b9dc46edea036ee62044b2b461c925732f8635c1#scout4cars/Android-Java/denaliNavigationView/src/main/java/com/telenav/arp/sdk/widget/NavigationStatusCallback.java)

navigationView

更新porchview上的smart gas和 parking

AIDL: BaseNavigationServicePrivate.java

UI: 

```
public Bundle getNavUIContent(NavUIStatus navUIStatus)
```

[ NavUIContent.java](https://bitbucket.telenav.com/projects/AUT/repos/java-sdk-common/commits/9c6220972f9844af8a51b8f16c106d8bbb8097aa#java_sdk/arp-foundation/src/main/java/com/telenav/arp/service/navigation/NavUIContent.java)

传值

大图标：

```
navUIContent.turnIconId 
```

小图标：tightTurnIconId

## HUD

啓動

https://spaces.telenav.com:8443/pages/viewpage.action?pageId=206243581

大图标：turnIconSecondary

大图标下面的小图标：tightTurnIconSecondaryId

## Bench

开机键在后面, 按了开机键后，点下

## RSI

```
=https://artifactory.telenav.com/telenav-maven-public
```

gradle.properties加上

[RouteListFragment.java](https://bitbucket.telenav.com/projects/AUT/repos/hmi-common/commits/ad7dc4adedf960d23fb9bcaf72b2b87c46c910ee#NavHome/Apps/RSI/app/src/main/java/com/telenav/arp/module/navigation/routeList/RouteListFragment.java) 显示LIST

[BaseNavigationServicePrivate.java ](https://bitbucket.telenav.com/projects/AUT/repos/hmi-common/commits/ad7dc4adedf960d23fb9bcaf72b2b87c46c910ee#NavHome/module/mainshared/src/main/java/com/telenav/arp/module/BaseNavigationServicePrivate.java)接受值

Rain: NavigationServicePrivate

## Page, fragment

当你打开一个新的page的时候，fragment会利用flowinfo去set一个pagedata（bundle）。

然后FlowManager才可以start 整个info。

https://spaces.telenav.com:8443/display/~bdgong@telenav.cn/2016/12/06/Flow+Page+Pattern+of+Denali+HMI

更新flow栈，page栈

为什么，在doneToUse方法中的pagedata可以变成fragment的bundledata从而可以在onPageBack中识别出needQuery的值呢？

因为updateFragmentBundle这个方法会把pagedata放到FragmentBundle里面去，而这个方法只有在构造函数和onback方法才会被触发，所以在remove filters的时候不能用这个，需要直接获取page去修改字段。

## Logshed

mount -o rw,remount /mnt/media_rw/sdcard0/vol1

https://spaces.telenav.com:8443/display/~bzhang2@telenavsoftware.com/How+to+test+logshed

```
handleCachedEventsAfterStateCompleted
```

如果不开optin， 那么遇到sd card change 会是空的。

guest用户默认是optout

### cash的东西存哪了

```
cachedEventsBeforeStateComplete
LOG_STATE.COMPLETE之前收集，之后remove
```

#### cash 收集的时候log 是否初始化完了？

```
setSmartFeatureEnabled中才init
```

### 为什么sd card change后，会null.

```
dolog的时候会添加cash，之前会initFeatureCollection，然后才init，也就是说添加进cash的时候还没有init
```

### 新的进程起来后，它怎么知道之前的进程crash了？

```
waitForSDCard->recordLogshed->logAppCrash
```

### 记录各种事件的log在哪

```
logSDCardChange
```

## WIFI

guest: 12345abcde

test: 1a2b3c4d5e

## SIGN IN

```
signIn -> startLogin
```

## Annotation 

样式由map engine 控制

重要类：

```
PoiMapAnnotation
```

```
PoiOnMapLoader
```

json配置文件：

```
D:\Denali\hmi-common\NavHome\Apps\Denali\HMI\src\main\assets\af\mapengine_config\config\config_map_view.json
```

```
ParkingDecorator -> GLMapAddressAnnotation
```

### flow

```
DecoratorManager.checkLowBattery->addDecorator->onDecoratorStart->

AbstractDecorator.update->show->SmartGasDecorator(显示什么就会进入什么在这里gas和电池都会用smartgas).show->showGasAnnotations->showtpye=smartev->

PoiOnMapLoader.onUpdateSmartPOIs->updatePoiOnMap->resetPoiOnMap->mTileChecker.check->TileCheckTask->UpdateTask
```



### Rainier

https://spaces.telenav.com:8443/display/~glxue@telenavsoftware.com/Smart+Bubble+--annotation

## JUNCTION VIEW

> 01-01 00:09:47.650 18980-19463/? I/AutoSdkNavigationServiceJNI: HMI set JunctionArrowColor: -21956

配置会发给navkit，箭头是黄的，因为本来是绿的，叠加就是蓝色的。

## navkit

在mainApplication中配置。

初始化：NavKitInitializationTask

# BUG

Navigation action cannot be found in the current destination

https://nezspencer.medium.com/navigation-components-a-fix-for-navigation-action-cannot-be-found-in-the-current-destination-95b63e16152e

# Section speed camera

https://jira.telenav.com:8443/browse/DEN-54165

# **fuel status**

> **01-01 00:16:34.085 21458 21458 I com.telenav.arp: Denali-HMI: com.telenav.arp.decorator.DecoratorManager: check low fuel status on launch app: true**

# school zone

https://jira.telenav.com:8443/browse/RAIN-16105

提醒音：com.telenav.arp.tts.RainierVoiceGuidancePlaybackStrategy: [audio] navigationVoiceGuidance called - texts = [School zone in one hundred feet], hintMuted = false

# Mviewer

1. open->mvd

2. select map folder

3. select->plugin->right click

   时间按照电脑的时间，但是美国时间，比如：美国的8am，需要电脑的8pm

# 平板：

C:\Users\mxshang>adb shell wm density
Physical density: 240

C:\Users\mxshang>adb shell wm size
Physical size: 1200x2000
